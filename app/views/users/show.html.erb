<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="user__box">
        <% if policy(@user).update? %>
            <h1><%= "My profile" %></h1>
          <% else %>
            <h1><%= "Profile of #{@user.first_name.capitalize}" %></h1>
          <% end %>
        <p>
          <% user_avatar = @user.facebook_picture_url || @user.avatar || "default-avatar.png" %>
          <%= cl_image_tag user_avatar, class: "avatar__profile", width: 400, height: 400, crop: :fill, gravity: :face %>
        </p>
        <p>
          <% if @user.reviews.any? %>
            <%= render "average_review_ratings" %>
          <% end %>
        </p>
        <div class="user__form__details">
          <% if policy(@user).edit? %>
            <%= simple_form_for(@user) do |f| %>
              <%= f.error_notification %>
              <div class="form-row">
                  <%= f.input :first_name, input_html: { class: 'user__form__text' }, label_html: { class: "user__form__label" }, wrapper_html: {class: "col-xs-6"}, placeholder: "enter your first name" %>

                  <%= f.input :last_name, input_html: { class: 'user__form__text' }, label_html: { class: "user__form__label" }, wrapper_html: {class: "col-xs-6"}, placeholder: "enter your last name" %>
              </div>

              <div class="form-row">
                <%= f.input :email, input_html: { class: 'user__form__text' }, label_html: { class: "user__form__label" }, wrapper_html: {class: "col-xs-6"}, placeholder: 'youremail@example.com' %>

                <%= f.input :age, input_html: { class: 'user__form__text' }, label_html: { class: "user__form__label" }, wrapper_html: {class: "col-xs-6"}, placeholder: "enter your age" %>
              </div>

              <div class="form-row">
                  <%= f.input :description, as: :text, input_html: { class: 'user__form__text' }, label_html: { class: "user__form__label" }, wrapper_html: {class: "col-xs-12"}, placeholder: 'enter a description of yourself', input_html:{ class: 'user__form__text' } %>
              </div>

              <div class="form-row">
                <div class="form-actions user__form__button">
                  <%= f.submit "Validate", class: "btn btn-success" %>
                </div>
              </div>
            <% end %>
          <% else %>
            <ul style="list-style-type: none;">
              <li><%= " #{@user.first_name.capitalize}" %></li>
              <li><%= " Age: #{@user.age}" %></li>
              <li><%= " #{@user.description}" %></li>
            </ul>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <div class="user__box__title">
        <% if policy(@user).update? %>
          <% if @user.reviews.any? %>
            <h2><%= "My reviews" %></h2>
          <% else %>
            <h2><%= "You have no review yet" %></h2>
          <% end %>
        <% else %>
          <% if @user.reviews.any? %>
            <h3><%= "Reviews of #{@user.first_name.capitalize}" %></h3>
          <% else %>
            <h2><%= "#{@user.first_name.capitalize} has no review yet" %></h2>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="user__box__title">
    <%= render "reviews_details" %>
  </div>
  <div class="row" id="trips">
    <div class="col-xs-12">
      <div class="user__box__title" >
        <% if @trips.any? %>
          <% if policy(@user).show? %>
            <% if policy(@user).edit? %>
              <h2 style="text-align: center;"><%= "My trips" %></h2>
            <% else %>
              <h2 style="text-align: center;"><%= "Trips of #{@user.first_name}" %></h2>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row">
    <% @trips.each do |trip|%>
      <div class="col-xs-12 col-sm-6">
        <%= render "trips/trip-card", trip: trip %>
      </div>
    <% end %>
  </div>
</div>


